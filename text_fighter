import random
import sys
import time

done = False
level = 0
hp = 450
healers = 10
score = 0
toaster_encounters = 0
enemy_hp = 25912830985787234987293847
passcode = "OIOIOIGETMEIN"
# doesn't matter because it will change after, just to define enemy_hp
enemies = ["Bed", "Toaster", "Sofa", "Lamp", "Car"]
spring = False
inventory = []
onlyonce = False
single = False

def press_enter():
    print("\n\033[5m<Press enter to continue>\033[0m")
    input()

def typewriter(text, delay=0.03):
    for char in text:
        sys.stdout.write(char)
        sys.stdout.flush()
        time.sleep(delay)
    print() 

class Color:
    PURPLE = '\033[95m'
    CYAN = '\033[96m'
    DARKCYAN = '\033[36m'
    BLUE = '\033[94m'
    GREEN = '\033[92m'
    YELLOW = '\033[93m'
    RED = '\033[91m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'
    END = '\033[0m'

# credit to AI to help search and fine these





print("--- WELCOME ---")

name = input("Enter your name to play: ").strip()

if len(name) > 25:
    typewriter("You joking? What kind of name is that long?!?!")
    sys.exit()  

if name.lower() in ["poo", "poop", "poopy", "poopypants", "idiot"]:
    print("That is very immature!")
    sys.exit()

elif name == "":
    print("Well... You have to have a name!")
    sys.exit()

elif name == "89Pexel":
    typewriter("Are you kidding me?? Oh fine, I'll give you a chance.")
    typewriter("What is the passcode? (Totally not Letmein1)")
    passcode = input()
    if passcode == "OIOIOIGETMEIN":
        typewriter("Yes!! Amazing!!! How did you know??? Oh of course you are...")
        typewriter("That's wrong...")
        sys.exit()

    else:
        print("How did you know??? You must be a genius!")
        print("Or actually 89Pexel...")
        print("Please wait for your secret access... 3 seconds.")
        time.sleep(3)
        typewriter("Well I don't believe in you...")
        sys.exit()


typewriter(f"Thank you {name} for playing, I hope you enjoy this game!")

press_enter()

print("Please note that using certain terminals won't work with the blinking text, VS CODE's terminal won't show the blinking text,")
print("command prompt has a chance of working and not working, if it does work at first then it'll be fine for the rest of the time.")
typewriter("Thank you to 89Pexel for coding this game (myself). Thank you to Jotham for adding this and advertising this game.")
typewriter("Thank you for playing this game, I didn't make the enemies as thugs or some of you might get nightmares, just ask and I'll make a new version.")

while hp > 0:
    current_enemy = random.choice(enemies)
    print(f"\n*** A wild {current_enemy} appeared! ***")

    if current_enemy == "Toaster":
        enemy_hp = random.randint(55, 80)
        toaster_encounters += 1
    if current_enemy == "Bed":
        enemy_hp = random.randint(50, 65)
    if current_enemy == "Sofa":
        enemy_hp = random.randint(60, 85)
    if current_enemy == "Lamp":
        enemy_hp = random.randint(50, 70)
    if current_enemy == "Car":
        enemy_hp = random.randint(60, 95)
    if current_enemy == "Bread":
        enemy_hp = random.randint(75, 95)
    if current_enemy == "Toast":
        enemy_hp = random.randint(80, 100)
    if current_enemy == "Pizza":
        enemy_hp = random.randint(87, 95)
    if current_enemy == "Marshmallows":
        enemy_hp = random.randint(89, 100)

    
    while enemy_hp > 0 and hp > 0:
        print(f"\n[ {current_enemy}: {enemy_hp} HP ] | [ YOU: {hp} HP | Healers: {healers} ] | Level: {level}")
        choice = input(f"Actions: [1] Attack [2] Heal [3] Use Item [4] Inventory: ")


        if choice == "3":
            if not inventory:
                print("You have no items to use!")
                continue
            else:
                print(f"Available items: {inventory}")
                use_what = input("What do you want to use? ").strip()
                if use_what in inventory:
                    if use_what == "Lightbulb":
                        print("You threw a Lightbulb! The enemy is blinded! -25 enemy health!")
                        enemy_hp -= 25
                        inventory.remove("Lightbulb")
                    elif use_what == "Spring":
                        print("You throw the spring... it bounces off the enemy's head. Boring. -2 enemy health...")
                        enemy_hp -= 2
                        inventory.remove("Spring")
                    elif use_what == "Pepperoni":
                        print("You throw the Pepperoni, it poisons the opponent! -30 enemy health!")
                        enemy_hp -= 30
                    elif use_what == "Dough":
                        print("You gain 3 healers!!!")
                        healers += 3
                        inventory.remove("Pepperoni")
                        inventory.remove("Dough")
                    elif use_what == "Screw":
                        print("Are you sure? It will destroy the opponent immediately, best to save when your dying.")
                        print("Also, you can only gain this item once, which is the one you have right now.")
                        print("Press 1 to use, press anything else to cancel.")
                        screw_choice = input(">> ")
                        if screw_choice == "1":
                            print("1000000 damage to opponent!")
                            enemy_hp -= 1000000
                            inventory.remove("Screw")
                    elif use_what == "Metal":
                        typewriter("It explodes!")
                        typewriter("You found a 'Shard'!")
                        inventory.remove("Metal")
                        inventory.append("Shard")
                    elif use_what == "Shard":
                        typewriter("+50 health!!!!")
                        hp += 50
                        inventory.remove("Shard")
                        
                else:
                    print("You aren't carrying that!")
               

        elif choice == "4":
            print("\n--- INVENTORY ---")
            if not inventory:
                print("Your pockets are empty...")
            else:
                for item in set(inventory):
                    print(f"- {item} (x{inventory.count(item)})")
            print("-----------------")
            continue

      
        elif choice == "2":
            if healers > 0:
                hp += 25
                healers -= 1
                print(f"{Color.GREEN}Healed +25 HP!{Color.END}")
            else:
                print("No healers left!")
                continue
        if current_enemy == "Toaster":
            if choice == "1":
                dmg = random.randint(10, 15)

                if random.random() < 0.2: 
                   dmg = dmg * 2
                   print(f"{Color.RED}CRITICAL HIT!{Color.END}")

                enemy_hp -= dmg
                hp -= 5 
                print(f"You punch the metal! {dmg} dmg to it, 5 dmg to you.")
            elif choice == "2":
                if healers > 0:
                    hp += 25
                    healers -= 1


        
        elif current_enemy == "Bed":
            if choice == "1":
                dmg = random.randint(5, 13)

                if random.random() < 0.2: 
                    dmg = dmg * 2
                    print(f"{Color.RED}CRITICAL HIT!{Color.END}")


                enemy_hp -= dmg
                print(f"You unscrew the Bed! {dmg} damage.")


        
        elif current_enemy == "Sofa":
            if choice == "1":
                dmg = random.randint(8, 12)

                if random.random() < 0.2:
                    dmg = dmg * 2
                    print(f"{Color.RED}CRITICAL HIT!{Color.END}")

                enemy_hp -= dmg
                hp += 2 
                print(f"Soft punch! {dmg} dmg. The cushions heal you +2 HP. Lower damage due to the cushions.")



        
        elif current_enemy == "Lamp":
            if choice == "1":
                dmg = random.randint(5, 17)

                if random.random() < 0.2:
                    dmg = dmg * 2
                    print(f"{Color.RED}CRITICAL HIT!{Color.END}")

                enemy_hp -= dmg
                print(f"You smash the bulb! {dmg} damage.")


        if current_enemy == "Car":
            if choice == "1":
                dmg = random.randint(10, 25)

                if random.random() < 0.2: 
                   dmg = dmg * 2
                   print(f"{Color.RED}CRITICAL HIT!{Color.END}")

                enemy_hp -= dmg
                hp -= 7 
                print(f"You punch the metal! {dmg} dmg to it, 7 dmg to you.")
            elif choice == "2":
                if healers > 0:
                    hp += 25
                    healers -= 1
                    print("Healed +25 HP!")
            else: print("No healers left!")

        if current_enemy == "Bread":
            if choice == "1":
                dmg = random.randint(10, 27)

                if random.random() < 0.2: 
                   dmg = dmg * 2
                   print(f"{Color.RED}CRITICAL HIT!{Color.END}")

                enemy_hp -= dmg
                hp -= 5
                print(f"You punch the food! {dmg} dmg to it, 5 dmg to you... Who knows why?")



        if current_enemy == "Toast":
            if choice == "1":
                dmg = random.randint(5, 20)

                if random.random() < 0.2: 
                   dmg = dmg * 2
                   print(f"{Color.RED}CRITICAL HIT!{Color.END}")

                enemy_hp -= dmg
                hp += 5
                print(f"You eat the food! {dmg} dmg to it, +5 health to you... Delicious!")

        if current_enemy == "Pizza":
            if choice == "1":
                dmg = random.randint(5, 25)

                if random.random() < 0.2: 
                   dmg = dmg * 2
                   print(f"{Color.RED}CRITICAL HIT!{Color.END}")

                enemy_hp -= dmg
                print(f"You eat the food! {dmg} dmg to it!")

        if current_enemy == "Marshmallows":
            if choice == "1":
                dmg = random.randint(10, 17)

                if random.random() < 0.2: 
                   dmg = dmg * 2
                   print(f"{Color.RED}CRITICAL HIT!{Color.END}")

                enemy_hp -= dmg
                print(f"You roast the marshmallow then eat it! {dmg} dmg to it!")
            elif choice == "2":
                if healers > 0:
                    hp += 25
                    healers -= 1


            


        
        if enemy_hp > 0 and hp > 0:
            if random.random() < 0.20:
                print(f"The {current_enemy} tried to hit you but MISSED!")
            else:
                if current_enemy == "Toaster":
                    e_dmg = random.randint(5, 17)
                    hp -= e_dmg
                    print(f"The {current_enemy} hits back for {e_dmg}!")
                if current_enemy == "Bed":
                    e_dmg = random.randint(4, 20)
                    hp -= e_dmg
                    print(f"The {current_enemy} hits back for {e_dmg}!")
                if current_enemy == "Sofa":
                    e_dmg = random.randint(4, 15)
                    hp -= e_dmg
                    print(f"The {current_enemy} hits back for {e_dmg}!")
                if current_enemy == "Lamp":
                    e_dmg = random.randint(5, 18)
                    hp -= e_dmg
                    print(f"The {current_enemy} hits back for {e_dmg}!")
                if current_enemy == "Car":
                    e_dmg = random.randint(7, 20)
                    hp -= e_dmg
                    print(f"The {current_enemy} hits back for {e_dmg}!")
                if current_enemy == "Bread":
                    e_dmg = random.randint(7, 22)
                    hp -= e_dmg
                    print(f"The {current_enemy} hits back for {e_dmg}!")
                if current_enemy == "Toast":
                    e_dmg = random.randint(5, 17)
                    hp -= e_dmg
                    print(f"The {current_enemy} hits back for {e_dmg}!")
                if current_enemy == "Pizza":
                    e_dmg = random.randint(7, 15)
                    hp -= e_dmg
                    print(f"The {current_enemy} hits back for {e_dmg}!")
                if current_enemy == "Marshmallows":
                    e_dmg = random.randint(8, 23)
                    hp -= e_dmg

    
    if hp > 0:
        score += 1
        print(f"\n--- VICTORY! You destroyed a {current_enemy}! ---")
        print(f"Total enemies defeated so far: {score}")

        

        if spring == False:
            if current_enemy == "Toaster":
                if random.random() < 0.3:
                    print("You find a 'Spring' inside the Toaster!")
                    inventory.append("Spring")
                    spring = True
        
        if spring == True:
            print(f"\nTo exchange for 1 healer press 1")
            choice = input(">> ")
            
            if choice == "1":
                inventory.remove("Spring")
                healers += 1
                spring = False
                print("You used the spring to get a healer! (+1 Healer)")

        if current_enemy == "Lamp":
            if random.random() < 0.3:
                print("The Lamp dropped a 'Lightbulb'!")
                inventory.append("Lightbulb")
        
        if current_enemy == "Pizza":
            if random.random() < 0.3:
                print("The pizza dropped a 'Pepperoni'!")
                inventory.append("Pepperoni")
        
        if current_enemy == "Bread":
            if random.random() < 0.07:
                print("The bread drouped 'Dough'!")
                inventory.append("Dough")
        
        if current_enemy == "Car":
            if random.random() < 0.7:
                if onlyonce == False:
                    print("The car dropped a 'Screw'!")
                    inventory.append("Screw")
                    onlyonce = True
                elif onlyonce == True:
                    continue
        
        
        if done == True:
            print()

        elif done == False:
            if score == 1:

               typewriter(f"\n{name}: I bought too much furniture...")

               press_enter()

               done = True
        
        if score == 5:
            
            press_enter()

            typewriter(f"{name}: Why did I buy so much toasters?")
            typewriter("Your skill level is now 1!")
            typewriter("+3 healers!")

            press_enter()
            level = 1
            healers += 3
            

        if score == 7:

            press_enter()

            print(f"{name}: I guess I went on a 24 hour shopping spree...")

            press_enter()

        if score == 9:

            press_enter()

            print(f"{name}: Am I really that rich to have that much cars?")

            press_enter()

        if score == 10:
            typewriter("Next area!!! Food!")
            typewriter("Your health is 350 and you have gotten +5 healers!")

            press_enter()

            enemies = ["Bread", "Toast", "Pizza", "Marshmallows"]
            hp = 350
            healers += 5
        
        if score == 12:

            press_enter()
            
            typewriter("Who bought so much food? (Next level at 23 kills)")

            press_enter()
        
        if score == 23:

            press_enter()

            typewriter("Your new skill level is 2")

            level = 2

        if score == 5:
            if single == False:
                typewriter("You find metal, its weird shaped...")
                print("You found 'Metal'!")
                inventory.append("Metal")
                single = True
            elif single == True:
                continue

        
        if score == 1 or score == 3 or score == 4:
            current_enemy = "Toaster"


        
        
        if random.random() < 0.3:
            healers += 1
            messages = [
            "You squint your eyes as you see something unusual... It's a healer in the wreckage!",
            "You feel like you spotted something off. Then you realise its a healer!",
            "You search the wreckage for any valuable things, you find a healer!",
            "You see a glimmer of something... Oh... It's a healer!",
            "What's that? Interesting, wait a second... It's a healer!"
            ]
            print(random.choice(messages))
        
    else:
        if score >= 11:
            print(f"\n--- You lose ---")
            print(f"Final Score: {score} enemies defeated.")
            print("You have beaten over 10 enemies. Congratulations!")
            print("Amazing!")
        else:
            print(f"\n--- You lose ---")    
            print(f"Final Score: {score} enemies defeated.")
            print("Nice!")
